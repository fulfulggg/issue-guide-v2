# Project TODO

## Phase 1: プロジェクト構造とデザイン方針の決定
- [x] デザインシステムの決定（カラーパレット、タイポグラフィ、レイアウト）
- [x] グローバルスタイルの設定

## Phase 2: コンテンツデータの構造化とコンポーネント設計
- [x] 質問力コンテンツのデータ構造化
- [x] 9つの領域の質問例データ作成
- [x] 30日間トレーニングプログラムのデータ設計
- [x] 再利用可能なUIコンポーネントの設計

## Phase 3: メインページとナビゲーションの実装
- [x] ヘッダーナビゲーションの実装
- [x] ホームページ（概要セクション）の実装
- [x] 3つのレベル説明セクションの実装
- [x] 9つの領域セクションの実装
- [x] 質問の名手セクションの実装
- [x] 習慣形成セクションの実装
- [x] レスポンシブデザインの調整

## Phase 4: 30日間トレーニング機能の実装
- [x] トレーニングページのルーティング追加
- [x] 日別質問記録機能（LocalStorage使用）
- [x] 進捗表示機能
- [x] カテゴリ別トレーニングガイド

## Phase 5: 最終調整とチェックポイント作成
- [x] 全ページの動作確認
- [x] モバイル表示の最終確認
- [x] パフォーマンス最適化
- [x] チェックポイント作成

## Phase 6: 成果物の提供
- [x] ユーザーへの最終成果物提供

## 新機能追加: 質問ライブラリとAIフィードバック

### 質問ライブラリ
- [x] 9つのカテゴリ別に質問例データを作成（各カテゴリ15-20問）
- [x] 質問ライブラリページのルーティング追加
- [x] カテゴリフィルター機能の実装
- [x] 検索機能の実装
- [x] お気に入り機能（LocalStorage）の実装
- [x] 質問カードUIの実装

### AIフィードバック機能
- [x] AIフィードバックAPI統合
- [x] トレーニングページにAIフィードバックボタン追加
- [x] フィードバック結果表示UIの実装
- [x] 質問の評価ロジック実装
- [x] 改善提案の表示機能

### 最終調整
- [x] 全機能の動作確認
- [x] チェックポイント作成

## コンテンツ深化改訂: 質問力の本質的強化

### Phase 1: コンテンツ改訂計画とデータ構造の拡張
- [ ] 5段階質問階層のデータ構造設計
- [ ] 偉人の質問データベース構造設計
- [ ] 人生を変える質問のカテゴリ設計
- [ ] 深層質問ライブラリの分類体系設計

### Phase 2: 偉人の質問研究と実例収集
- [x] ソクラテス：産婆術の実践例20問収集
- [x] ファインマン：5回のWhyの実例収集
- [x] アインシュタイン：思考実験の質問収集
- [x] ドラッカー：本質を突く経営の問い収集
- [x] 禅師：公案（矛盾を通じた悟り）収集
- [x] 各偉人の質問パターン分析と解説作成

### Phase 3: 5段階質問階層とUI改訂
- [x] レベル1-5の詳細説明コンテンツ作成
- [x] 各レベルの具体例と実践ガイド作成
- [x] ホームページの階層セクション改訂
- [x] レベル間の移行を示すビジュアル実装

### Phase 4: 人生を変える質問セクションの実装
- [x] 実存的な問い（死・意味・目的）のコンテンツ作成
- [x] ビッグアハを生む質問の構造分析
- [x] 自己変容を促す問いかけのデータ作成
- [x] 新規ページまたはセクションのUI実装

### Phase 5: 深層質問ライブラリの追加
- [x] 「深層質問」カテゴリの追加（135問）
- [x] 実際に人生・ビジネスを変えた質問の実例収集
- [ ] 各質問の背景ストーリーと効果の記述
- [x] ライブラリページへの統合

### Phase 6: 最終確認とチェックポイント作成
- [x] 全コンテンツの整合性確認
- [x] 深化した内容の動作確認
- [x] チェックポイント作成

## プロフェッショナル機能追加: コーチング・ファシリテーション観点の統合

### Phase 1: 新機能の設計とデータ構造の追加
- [x] 8つの評価観点のデータ構造設計（ポジティブ前提、謙虚さ、主体性、感情アクセス、行動性、オープン度、シンプルさ、フェーズ適合）
- [x] 質問タイプ分類の定義（明確化、前提破壊、視点変更、行動喚起、感情・価値観）
- [x] チェックリスト項目の設計
- [x] フェーズ別質問データの構造化

### Phase 2: 質問の多次元評価システムの実装
- [x] 8観点評価ロジックの実装
- [x] スコアリングアルゴリズムの実装
- [x] 評価結果表示UIの作成
- [x] 観点別改善提案の生成ロジック

### Phase 3: 質問タイプ分類とタグシステムの実装
- [x] 質問ライブラリへのタグ付け
- [x] タグフィルター機能の実装
- [x] タイプ別トレーニングモードの実装
- [x] タグ別質問統計の表示

### Phase 4: 良い質問のチェックリスト機能の実装
- [ ] 10項目チェックリストの作成
- [ ] セルフレビューUIの実装
- [ ] チェックリスト結果の保存機能
- [ ] トレーニングページへの統合

### Phase 5: フェーズ別質問ガイドとAIセクションの実装
- [ ] 発散・収束・実行フェーズの質問データ作成
- [ ] フェーズ別ガイドページの実装
- [ ] Appreciative Inquiry専用セクションの作成
- [ ] Humble Inquiry技法の解説追加
- [ ] ICFコーチング観点の統合

### Phase 6: 最終確認とチェックポイント作成
- [ ] 全機能の動作確認
- [ ] プロフェッショナル機能の整合性確認
- [ ] チェックポイント作成

## 質問の名手セクション大幅拡充

### Phase 1: 質問の名手データの構造化
- [x] ソクラテスの7つの質問パターン詳細データ作成
- [x] トヨタ5回のWhyの実践例データ作成
- [x] ドラッカーの5つの質問詳細データ作成
- [x] 禅の公案データ作成
- [x] アインシュタインの思考実験データ作成
- [x] ファインマンの12の問題手法データ作成

### Phase 2: ホームページの名手セクション大幅拡充
- [x] 各偉人の詳細カード作成
- [x] 実践例・問答例の表示
- [x] 偉人別詳細ページへのリンク追加

### Phase 3: 偉人別詳細ページの作成
- [x] ソクラテス詳細ページ作成
- [x] トヨタ5Whys詳細ページ作成
- [x] ドラッカー詳細ページ作成
- [x] 禅詳細ページ作成
- [x] アインシュタイン詳細ページ作成
- [x] ファインマン詳細ページ作成

### Phase 4: 質問ライブラリへの偉人の質問追加
- [x] 「偉人の質問」カテゴリ追加
- [x] 各偉人の代表的な質問20問以上追加

### Phase 5: 最終確認とチェックポイント作成
- [x] 全コンテンツの整合性確認
- [x] チェックポイント作成

## 100名規模偉人質問集の実装

### Phase 1: 偉人リストの選定とデータ構造設計
- [x] 100名の偉人リスト選定（哲学者、科学者、経営者、心理学者、宗教家、作家等）
- [x] 思考スタイル分類の定義（前提破壊、本質追求、実験思考、内省等）
- [x] メタ情報スキーマ設計（深度・レベル・領域・フェーズ・時間軸・用途）
- [x] データ構造の設計（JSON形式）

### Phase 2: 第一弾コア偉人20-30名のデータ作成
- [x] コア偉人20-30名の選定
- [x] 各偉人の詳細プロフィール作成（5名完了：ソクラテス、プラトン、アリストテレス、デカルト、カント）
- [x] 各偉人20-30問の質問セット作成（5名100問完了）
- [x] 思考スタイル・用途タグ付け

### Phase 3: 第二弾拡張偉人70-80名のデータ作成
- [ ] 拡張偉人70-80名の選定
- [ ] 各偉人の簡潔なプロフィール作成
- [ ] 各偉人10-15問の質問セット作成
- [ ] 思考スタイル・用途タグ付け

### Phase 4: 偉人の問い専用タブとフィルタリングUIの実装
- [x] 「偉人の問い」専用ページ作成
- [x] 思考スタイル別フィルター実装
- [x] 分野別フィルター実装
- [x] 用途別フィルター実装
- [x] 検索機能実装

### Phase 5: 質問レシピ機能の実装
- [ ] レシピデータ構造設計
- [ ] シナリオ別レシピ作成（キャリア、1on1、新規事業、自己内省等）
- [ ] レシピ表示UI実装
- [ ] 「今日のレシピ」ランダム機能実装

### Phase 6: 最終確認とチェックポイント作成
- [ ] 全機能の動作確認
- [ ] チェックポイント作成

## 偉人の問い詳細情報追加: 一般ユーザー向け改善

### Phase 1: 質問データ構造の拡張設計
- [x] 用語解説フィールドの追加
- [x] 具体例フィールドの追加
- [x] 使い方ガイドフィールドの追加
- [x] 期待される効果フィールドの追加

### Phase 2: 5名100問の詳細情報追加
- [x] ソクラテス20問の詳細情報追加
- [x] プラトン20問の詳細情報追加
- [x] アリストテレス20問の詳細情報追加
- [x] デカルト20問の詳細情報追加
- [x] カント20問の詳細情報追加

### Phase 3: UIの改訂と表示実装
- [x] 質問カードUIの拡張
- [x] 用語解説の表示実装
- [x] 具体例の表示実装
- [x] 使い方ガイドの表示実装
- [x] 期待される効果の表示実装

### Phase 4: 最終確認とチェックポイント作成
- [x] 全質問の詳細情報確認
- [x] UI表示の確認
- [x] チェックポイント作成

## 質問の深度体系統一: 3レベルから5段階深度へ

### Phase 1: 5段階深度の詳細設計とコンテンツ作成
- [x] 5段階深度の定義と説明文作成（既存のfiveLevelsデータを使用）
- [x] 各深度の具体例作成（既存のfiveLevelsデータを使用）
- [x] 各深度の実践ガイド作成（既存のfiveLevelsデータを使用）
- [x] 深度間の関係性の明確化（levelTransitionsデータで実装済み）

### Phase 2: ホームページの3レベルセクションを5段階深度に改訂
- [x] 3レベルセクションを削除（5段階深度セクションは既に存在）
- [x] UIデザインの調整（id属性を追加）
- [x] レスポンシブ対応の確認（既存の5段階セクションが対応済み）

### Phase 3: データ構造との整合性確認と最終調整
- [x] 偉人の問いデータのdepthフィールドとの整合性確認
- [x] 全ページでの表記統一確認（AIフィードバックダイアログを修正、content.tsから古いデータを削除）
- [x] 動作確認

### Phase 4: チェックポイント作成とユーザーへの報告
- [x] チェックポイント作成
- [ ] ユーザーへの報告

## 偉人の質問セクション大幅拡充

### Phase 1: トップページの質問の名手セクションから詳細リンクを削除
- [x] 詳細ページへのリンクを削除

### Phase 2: 偉人のタブのデータ構造を拡張設計
- [x] 生没年フィールド追加（periodフィールドが既に存在）
- [x] 詳細解説フィールド追加（detailedBio）
- [x] アプローチフィールド追加（approachDetail）
- [x] 主要原則フィールド追加（keyPrinciples）
- [x] 代表的な質問（質問文+解説）フィールド追加（representativeQuestions）

### Phase 3: 5名の偉人の詳細情報を作成
- [x] ソクラテスの詳細情報作成
- [x] プラトンの詳細情報作成
- [x] アリストテレスの詳細情報作成
- [x] デカルトの詳細情報作成
- [x] カントの詳細情報作成

### Phase 4: 偉人のタブUIを改訂して詳細情報を表示
- [x] 偉人カードUIの拡張
- [x] 詳細情報の表示実装

### Phase 5: チェックポイント作成とユーザーへの報告
- [x] チェックポイント作成
- [ ] ユーザーへの報告

## 偉人の問いタブ修正と偉人数拡充

### Phase 1: MastersQuestionsページをmasters.ts使用に変更
- [x] MastersQuestionsページのimportをcoreMastersData.tsからmasters.tsに変更
- [x] MastersQuestionsページのUIをmasters.tsのデータ構造に合わせて調整
- [x] フィルター機能の調整

### Phase 2: masters.tsに偉人を追加（50人程度）
- [x] 哲学者を追加（ニーチェ、ハイデガー、サルトル、フーコーなど10名程度）
- [x] 東洋思想家を追加（孔子、老子、荘子、ブッダなど7名程度）
- [x] 経営者・起業家を追加（ジョブズ、ベゾス、稲盛和夫など10名程度）
- [x] 経営学者を追加（クリステンセン、ポーター、コリンズなど5名程度）
- [x] 科学者を追加（アインシュタイン、ファインマン、ダーウィンなど5名程度）
- [x] その他の偉人を追加（ダ・ヴィンチ、フロイト、ユングなど8名程度）

### Phase 3: 動作確認とチェックポイント作成
- [x] 動作確認
- [x] チェックポイント作成

## ヘッダーナビゲーションのレスポンシブ対応改善

### Phase 1: ヘッダーナビゲーションのレスポンシブ対応修正
- [x] ヘッダーナビゲーションのスマホ対応修正
- [x] ハンバーガーメニューまたは縦並びレイアウトの実装
- [x] 画面幅に収まるように調整

### Phase 2: スマホ表示の確認と調整
- [x] スマホ画面での表示確認
- [x] タブレット画面での表示確認
- [ ] デスクトップ画面での表示確認

### Phase 3: チェックポイント作成とユーザーへの報告
- [ ] チェックポイント作成
- [ ] ユーザーへの報告

## ホームページの「質問の名手から学ぶ」セクション改善

### Phase 1: ホームページの偉人表示を5名に絞り込み
- [ ] 代表的な5名の偉人を選定（ソクラテス、ドラッカー、ジョブズ、孔子、アインシュタインなど）
- [x] ホームページで表示する偉人を5名に制限

### Phase 2: 詳細ページへのリンクボタンを追加
- [x] 「全ての偉人を見る」ボタンを追加
- [x] /masters-questionsページへのリンクを設定

### Phase 3: チェックポイント作成とユーザーへの報告
- [ ] チェックポイント作成
- [ ] ユーザーへの報告

## 5段階深度の分類見直し

### Phase 1: 5段階深度の定義を再確認
- [x] fiveLevels.tsの定義を確認
- [x] 各レベルの基準を明確化

### Phase 2: トヨタの「なぜ×5」の分類を修正
- [x] 現在の分類を確認（レベル2になっている）
- [x] 適切なレベル（レベル3またはレベル4）に修正

### Phase 3: 他の例も確認して不適切な分類があれば修正
- [x] 全ての例の分類を確認
- [x] 不適切な分類を修正

### Phase 4: チェックポイント作成と報告
- [ ] チェックポイント作成
- [ ] ユーザーへの報告

## Header.tsxのReact ref警告エラー修正

### Phase 1: Header.tsxのエラー原因を特定
- [ ] SheetTriggerとButtonの構造を確認

### Phase 2: SheetTriggerとButtonの構造を修正
- [x] asChildを使用してButtonをSheetTriggerの子要素として正しく配置

### Phase 3: チェックポイント作成と報告
- [ ] チェックポイント作成
- [ ] ユーザーへの報告

---

## Visual Editor（Phase1）: 動作確認手順 / Backout

### 前提
- dev server: `pnpm dev`（Vite）
- URL: http://127.0.0.1:3000/builder
- `data-loc` は `@builder.io/vite-plugin-jsx-loc` により JSX に注入される
- コード更新APIは **dev-only**（production では 404）

### 1) 手動動作確認（UI）
1. `pnpm -s check`（型チェック）
2. `pnpm dev --host 127.0.0.1 --port 3000`
3. ブラウザで `http://127.0.0.1:3000/builder` を開く
4. 左のプレビュー上の要素をクリック
   - 期待: 画面左上に `選択中: client/src/...:line` が表示される（EditorOverlay）
   - 期待: 選択要素の周りに青枠（実線＋ハンドル）が出る
5. 右側「AI 編集チャット」に任意の指示を入力して送信（AI APIキーが設定されている場合）
   - 期待: assistant の返答末尾に ```json で patch が含まれる
6. 「適用（/api/code/update）」を押す
   - 期待: `コードを更新しました（HMR反映）` の toast
   - 期待: Vite HMR によりプレビューが即更新される

### 2) API 単体動作確認（curl）
#### /api/code/context
```sh
curl -sSf -H 'Content-Type: application/json' \
  -d '{"filePath":"client/src/pages/Home.tsx","line":29,"radius":2}' \
  http://127.0.0.1:3000/api/code/context
```

#### /api/code/update
```sh
curl -sSf -H 'Content-Type: application/json' \
  -d '{"filePath":"client/src/pages/Home.tsx","lineStart":28,"lineEnd":28,"newCode":"        {/* Hero Section */}"}' \
  http://127.0.0.1:3000/api/code/update
```

### 3) トラブルシュート（クリックで選択できない場合）
- `data-loc` の形式が環境により `path:line` / `path:line:column` で変わる。
  - `parseDataLoc()` が両対応になっていることを確認（`client/src/contexts/VisualEditorContext.tsx`）。

### 4) Backout（撤回）
- Phase1 で本質的に追加したのは Visual Editor 周り（/builder置換、/api/ai/chat、/api/code/*）
- 「クリック選択」が再度壊れる場合、まず `parseDataLoc()` の解釈が `path:line` に対応できているかを確認。
- HMR 検証で `Home.tsx` を一時変更した場合は、必ず元のコードに戻す（コメント変更などでも変更は残るため）。
